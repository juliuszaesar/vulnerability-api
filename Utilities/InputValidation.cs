using System.Web;
using VulnerabilityApi.Data;
using VulnerabilityApi.Entities.DTOs;

namespace VulnerabilityApi.Utilities;
public class InputValidation
{
    // Sanitize inputs and HTML-encode to prevent XSS-attacks
    public static (string EncodedName, string? EncodedDescription) SanitizeVulnerability(AddVulnerabilityDto dto)
    {
        return (
            EncodedName: HttpUtility.HtmlEncode(dto.Name),
            EncodedDescription: dto.Description != null ? HttpUtility.HtmlEncode(dto.Description) : null
        );
    }

    public static (string EncodedName, string? EncodedDescription) SanitizeVulnerabilityUpdateInput(
        UpdateVulnerabilityDto dto)
    {
        return (
            EncodedName: HttpUtility.HtmlEncode(dto.Name),
            EncodedDescription: dto.Description != null ? HttpUtility.HtmlEncode(dto.Description) : null
        );
    }
}
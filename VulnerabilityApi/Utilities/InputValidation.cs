using System.Web;
using VulnerabilityApi.Entities.DTOs;

namespace VulnerabilityApi.Utilities;
public static class InputValidation
{
    // Sanitize inputs and HTML-encode to prevent XSS-attacks
    public static (string EncodedName, string? EncodedDescription) SanitizeVulnerability(AddVulnerabilityDto dto)
    {
        return (
            EncodedName: HttpUtility.HtmlEncode(dto.Name),
            EncodedDescription: HttpUtility.HtmlEncode(dto.Description)
        );
    }

    public static (string EncodedName, string? EncodedDescription) SanitizeVulnerabilityUpdateInput(
        UpdateVulnerabilityDto dto)
    {
        return (
            EncodedName: HttpUtility.HtmlEncode(dto.Name),
            EncodedDescription: HttpUtility.HtmlEncode(dto.Description)
        );
    }
}